# bollinger bands strategy: mathematical formulation

bollinger bands are a technical analysis tool defined by a set of three curves plotted in relation to an asset's price. these bands are used to measure volatility and identify overbought or oversold conditions.

## components of bollinger bands

bollinger bands consist of three lines:

1.  **middle band (mb)**: a simple moving average (sma) of the asset's closing prices.
    let $c_t$ be the closing price at time $t$. the sma for period $n$ at time $t$, denoted as $sma(c, n)_t$, is given by:
    $$ mb_t = sma(c, n)_t = \frac{1}{n} \sum_{i=0}^{n-1} c_{t-i} $$
    where $n$ is the lookback period (e.g., 20 periods).

2.  **upper band (ub)**: calculated by adding a certain number of standard deviations ($k$) to the middle band.
    $$ ub_t = mb_t + k \times \sigma_t $$
    where $k$ is the number of standard deviations (e.g., 2.0) and $\sigma_t$ is the standard deviation of the closing prices over the same $n$ period.

3.  **lower band (lb)**: calculated by subtracting the same number of standard deviations ($k$) from the middle band.
    $$ lb_t = mb_t - k \times \sigma_t $$

#### standard deviation ($\sigma$)
the standard deviation for a period $n$ at time $t$ is calculated as:
$$ \sigma_t = \sqrt{\frac{1}{n} \sum_{i=0}^{n-1} (c_{t-i} - mb_t)^2} $$

## trading signals

the trading signals are generated by comparing the asset's closing price with the bollinger bands.

-   **buy signal (long entry)**:
    a buy signal is generated when the asset's closing price crosses below the lower bollinger band. this suggests the asset is oversold and due for a potential rebound.
    mathematically, a buy signal occurs at time $t$ if:
    $$ c_t < lb_t \quad \text{and} \quad c_{t-1} \ge lb_{t-1} $$

-   **sell signal (long exit)**:
    a sell signal (to close a long position) is generated when the asset's closing price crosses above the middle bollinger band. this can indicate a loss of downward momentum or a move towards the asset's average price. (alternatively, crossing above the upper band could also be an exit signal).
    mathematically, a sell signal occurs at time $t$ if:
    $$ c_t > mb_t \quad \text{and} \quad c_{t-1} \le mb_{t-1} $$

the `basestrategy` then manages the position sizing, stop-loss, and take-profit levels once a trade is entered or exited.

## strategy parameters

the `bollinger bands strategy` is configured by the following parameters:

### bb period
-   **definition**: the number of periods used for the simple moving average that forms the middle bollinger band, and for calculating the standard deviation.
-   **significance**: similar to sma period, it affects the sensitivity of the bands. a shorter period makes the bands more reactive to recent price action, while a longer period makes them smoother.
-   **impact**:
    -   **shorter period**: bands are narrower, more reactive to price, leading to more frequent signals.
    -   **longer period**: bands are wider, less reactive, leading to fewer but potentially more significant signals.

### bb std dev
-   **definition**: the number of standard deviations used to calculate the upper and lower bollinger bands from the middle band.
-   **significance**: directly controls the width of the bollinger bands, thereby influencing the frequency of price touching or crossing the bands.
-   **impact**:
    -   **smaller std dev (e.g., 1.5)**: narrower bands, more frequent price touches/crosses, leading to more signals.
    -   **larger std dev (e.g., 2.5)**: wider bands, fewer price touches/crosses, leading to less frequent signals.
